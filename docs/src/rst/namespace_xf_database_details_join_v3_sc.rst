.. index:: pair: namespace; sc
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc:
.. _cid-xf::database::details::join_v3::sc:

namespace sc
============

.. toctree::
	:hidden:



.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a14a0558b808ea594c5e1d0e4706858c9:
.. _cid-xf::database::details::join_v3::sc::read_status:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a3919ef31c373538f3c4e600d12b12553:
.. _cid-xf::database::details::join_v3::sc::write_status:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ae963d179fd9b28332d5186a1c5939dab:
.. _cid-xf::database::details::join_v3::sc::read_bitmap:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a6c87094fd8a3350d7ad30459b7343bf5:
.. _cid-xf::database::details::join_v3::sc::combine_bitmap:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1aa86a188e6f907a44fd275ae69f18982d:
.. _cid-xf::database::details::join_v3::sc::write_uram:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a8dc424bc373ea7f5ad6957798bfe4b0b:
.. _cid-xf::database::details::join_v3::sc::read_uram:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ae2a892bc7a9774a6a20c9e631b722261:
.. _cid-xf::database::details::join_v3::sc::split_bitmap:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a6da21584754046a8619f08069b078d5c:
.. _cid-xf::database::details::join_v3::sc::write_bitmap:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1afb2b7a172282f34270a0f9a9d96d90c5:
.. _cid-xf::database::details::join_v3::sc::stb_addr_gen:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ad4107f8c45f898d946ad069899068b2e:
.. _cid-xf::database::details::join_v3::sc::read_row:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a8e042d28f11a2659eeaa3bf3d8f81e00:
.. _cid-xf::database::details::join_v3::sc::combine_row:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a01eba7487c30e51539a95207abcaf838:
.. _cid-xf::database::details::join_v3::sc::duplicate_strm_end:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ae0c31d372df80120c9a0b74908f9a18a:
.. _cid-xf::database::details::join_v3::sc::eliminate_strm_end:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ac47c8d0fde1c0c422a24f2e34d86be05:
.. _cid-xf::database::details::join_v3::sc::write_row:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a0a29a060ccce2236f05f370d8c8e472e:
.. _cid-xf::database::details::join_v3::sc::split_row:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ac22e006fd5659e158ecffe58e64b1c3e:
.. _cid-xf::database::details::join_v3::sc::dispatch_unit:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1aeffa03ee54f2f0ea862aeaeb020d2a72:
.. _cid-xf::database::details::join_v3::sc::dispatch_wrapper:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1aa51aff8252208bd60da330049f436099:
.. _cid-xf::database::details::join_v3::sc::merge1_1_wrapper:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1adb4ea6fffe3c614a72167bb5fd344ec0:
.. _cid-xf::database::details::join_v3::sc::merge2_1_wrapper:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a9237c3454927ac148888fc339269507d:
.. _cid-xf::database::details::join_v3::sc::merge4_1_wrapper:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ac08a56922010f47582c67463d028a1e5:
.. _cid-xf::database::details::join_v3::sc::read_addr_gen:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ac5eddcd915a142e8af63a38c91890fd2:
.. _cid-xf::database::details::join_v3::sc::merge_unit:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a86f999305b8c2458d9491ee5c70eb1fc:
.. _cid-xf::database::details::join_v3::sc::probe_addr_gen:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a7816400eb0164a2adab6d06aad52fc53:
.. _cid-xf::database::details::join_v3::sc::probe_addr_gen-2:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1acddf8ee89921fe555c87531a0729af56:
.. _cid-xf::database::details::join_v3::sc::read_overflow_stb:
.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ab528d4245c1d67b15585670cccf402a5:
.. _cid-xf::database::details::join_v3::sc::collect_unit:
.. ref-code-block:: cpp
	:class: overview-code-block





.. FunctionSection

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ad956cd4c9e6aabb0ae19281839401fc4:
.. _cid-xf::database::details::join_v3::sc::read_htb:

read_htb
--------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASHW,
	    int ARW
	    >
	void read_htb (
	    ap_uint <256>* htb_buf,
	    ap_uint <64> addr_shift,
	    ap_uint <72>* bit_vector
	    )

Read hash table from HBM/DDR to URAM.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a0271730f817b27328b83b33a6c7bfe3b:
.. _cid-xf::database::details::join_v3::sc::write_htb:

write_htb
---------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASHW,
	    int ARW
	    >
	void write_htb (
	    ap_uint <256>* htb_buf,
	    ap_uint <64> addr_shift,
	    ap_uint <72>* bit_vector
	    )

Write hash table from URAM to HBM/DDR.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1aaddd8daa5d476c5c74f813b5996f8b17:
.. _cid-xf::database::details::join_v3::sc::read_stb:

read_stb
--------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int ARW,
	    int RW
	    >
	void read_stb (
	    ap_uint <256>* stb_buf,
	    hls::stream <ap_uint <ARW>>& i_addr_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <RW>>& o_row_strm,
	    hls::stream <bool>& o_e_strm
	    )

Read s-table from HBM/DDR.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a2ffae1b9362a28f834c28f3c48fab8dd:
.. _cid-xf::database::details::join_v3::sc::write_stb:

write_stb
---------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int ARW,
	    int RW
	    >
	void write_stb (
	    ap_uint <256>* stb_buf,
	    hls::stream <ap_uint <ARW>>& i_addr_strm,
	    hls::stream <ap_uint <RW>>& i_row_strm,
	    hls::stream <bool>& i_e_strm
	    )

Write s-table to HBM/DDR.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1abf2620cd1c7a49201af8c9c576a2dc27:
.. _cid-xf::database::details::join_v3::sc::hash_wrapper:

hash_wrapper
------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASH_MODE,
	    int KEYW,
	    int HASHW
	    >
	void hash_wrapper (
	    hls::stream <ap_uint <KEYW>>& i_key_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <HASHW>>& o_hash_strm,
	    hls::stream <ap_uint <KEYW>>& o_key_strm,
	    hls::stream <bool>& o_e_strm
	    )

Calculate hash value based on key.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a8f15b1a0cb009f8ce48d30587b01c29b:
.. _cid-xf::database::details::join_v3::sc::dispatch:

dispatch
--------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int KEYW,
	    int PW,
	    int HASHWH,
	    int HASHWL,
	    int PU
	    >
	void dispatch (
	    hls::stream <ap_uint <KEYW>>& i_key_strm,
	    hls::stream <ap_uint <PW>>& i_pld_strm,
	    hls::stream <ap_uint <HASHWH+HASHWL>>& i_hash_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <KEYW>> o_key_strm [PU],
	    hls::stream <ap_uint <PW>> o_pld_strm [PU],
	    hls::stream <ap_uint <HASHWL>> o_hash_strm [PU],
	    hls::stream <bool> o_e_strm [PU]
	    )

Dispatch data to multiple PU based one the hash value, every PU with different high bit hash_value.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a86b454175d8e1f8dc39cd2ec18691b97:
.. _cid-xf::database::details::join_v3::sc::build_unit:

build_unit
----------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASHW,
	    int KEYW,
	    int PW,
	    int S_PW,
	    int ARW
	    >
	void build_unit (
	    ap_uint <32>& depth,
	    ap_uint <32>& overflow_length,
	    hls::stream <ap_uint <HASHW>>& i_hash_strm,
	    hls::stream <ap_uint <KEYW>>& i_key_strm,
	    hls::stream <ap_uint <PW>>& i_pld_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <ARW>>& o_addr_strm,
	    hls::stream <ap_uint <KEYW+S_PW>>& o_row_strm,
	    hls::stream <bool>& o_e_strm,
	    ap_uint <72>* bit_vector0,
	    ap_uint <72>* bit_vector1
	    )

Scan small table to count hash collision, build small table to its hash addr.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1add4b7d7778ce96d5d86c855a547f1000:
.. _cid-xf::database::details::join_v3::sc::build_wrapper:

build_wrapper
-------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASHW,
	    int KEYW,
	    int PW,
	    int S_PW,
	    int ARW
	    >
	void build_wrapper (
	    ap_uint <32>& depth,
	    ap_uint <32>& overflow_length,
	    hls::stream <ap_uint <HASHW>>& i_hash_strm,
	    hls::stream <ap_uint <KEYW>>& i_key_strm,
	    hls::stream <ap_uint <PW>>& i_pld_strm,
	    hls::stream <bool>& i_e_strm,
	    ap_uint <256>* stb_buf,
	    ap_uint <72>* bit_vector0,
	    ap_uint <72>* bit_vector1
	    )

Top function of hash join build.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1ac700fc880e8413f8a04853c9b9a18402:
.. _cid-xf::database::details::join_v3::sc::bitmap_addr_gen:

bitmap_addr_gen
---------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASHW,
	    int ARW
	    >
	void bitmap_addr_gen (
	    ap_uint <32>& depth,
	    ap_uint <32>& overflow_length,
	    ap_uint <72>* bit_vector1
	    )

Load overflow hash collision counter to genrate overflow hash bitmap.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a8d3e87696d4f1f4d06dcdd2ba8d2c97e:
.. _cid-xf::database::details::join_v3::sc::merge_stb:

merge_stb
---------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASH_MODE,
	    int HASHWH,
	    int HASHWL,
	    int KEYW,
	    int PW,
	    int ARW
	    >
	void merge_stb (
	    ap_uint <32>& depth,
	    ap_uint <32>& overflow_length,
	    ap_uint <256>* htb_buf,
	    ap_uint <256>* stb_buf,
	    ap_uint <72>* bit_vector
	    )

Merge overflow srow from htb to stb.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a2633822f6258ad3172d3505c80b5fffb:
.. _cid-xf::database::details::join_v3::sc::merge_wrapper:

merge_wrapper
-------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASH_MODE,
	    int HASHWH,
	    int HASHWL,
	    int KEYW,
	    int PW,
	    int ARW
	    >
	void merge_wrapper (
	    ap_uint <32>& depth,
	    ap_uint <32>& overflow_length,
	    ap_uint <256>* htb_buf,
	    ap_uint <256>* stb_buf,
	    ap_uint <72>* bit_vector
	    )

Top function of hash join merge.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a1700bb6bb5b4159f5573584a17affa55:
.. _cid-xf::database::details::join_v3::sc::probe_htb:

probe_htb
---------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASHW,
	    int KEYW,
	    int PW,
	    int B_PW,
	    int ARW
	    >
	void probe_htb (
	    ap_uint <32>& depth,
	    hls::stream <ap_uint <HASHW>>& i_hash_strm,
	    hls::stream <ap_uint <KEYW>>& i_key_strm,
	    hls::stream <ap_uint <PW>>& i_pld_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <ARW>>& o_base_addr_strm,
	    hls::stream <ap_uint <ARW>>& o_nm0_strm,
	    hls::stream <bool>& o_e0_strm,
	    hls::stream <ap_uint <ARW>>& o_overflow_addr_strm,
	    hls::stream <ap_uint <ARW>>& o_nm1_strm,
	    hls::stream <bool>& o_e1_strm,
	    hls::stream <ap_uint <KEYW>>& o_key_strm,
	    hls::stream <ap_uint <B_PW>>& o_pld_strm,
	    hls::stream <ap_uint <ARW>>& o_nm2_strm,
	    hls::stream <bool>& o_e2_strm,
	    ap_uint <72>* bit_vector0,
	    ap_uint <72>* bit_vector1
	    )

Probe the hash table and output address which hash same hash_value.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a43beceade2c48b5c882cc2d04dd27e77:
.. _cid-xf::database::details::join_v3::sc::probe_base_stb:

probe_base_stb
--------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int KEYW,
	    int S_PW,
	    int ARW
	    >
	void probe_base_stb (
	    ap_uint <32>& depth,
	    hls::stream <ap_uint <ARW>>& i_base_stb_addr_strm,
	    hls::stream <ap_uint <ARW>>& i_base_nm_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <KEYW>>& o_base_s_key_strm,
	    hls::stream <ap_uint <S_PW>>& o_base_s_pld_strm,
	    ap_uint <256>* stb_buf
	    )

Probe stb which temporarily stored in HBM.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a7736b5cc809bd1f80d7cfe523f813cb2:
.. _cid-xf::database::details::join_v3::sc::probe_overflow_stb:

probe_overflow_stb
------------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int KEYW,
	    int S_PW,
	    int ARW
	    >
	void probe_overflow_stb (
	    hls::stream <ap_uint <ARW>>& i_overflow_addr_strm,
	    hls::stream <ap_uint <ARW>>& i_overflow_nm_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <KEYW>>& o_overflow_s_key_strm,
	    hls::stream <ap_uint <S_PW>>& o_overflow_s_pld_strm,
	    ap_uint <256>* htb_buf
	    )

probe overflow stb which temporarily stored in HBM

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a46baff401edabf2536ac72443aa2e339:
.. _cid-xf::database::details::join_v3::sc::probe_wrapper:

probe_wrapper
-------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASHW,
	    int KEYW,
	    int PW,
	    int S_PW,
	    int T_PW,
	    int ARW
	    >
	void probe_wrapper (
	    ap_uint <32>& depth,
	    hls::stream <ap_uint <HASHW>>& i_hash_strm,
	    hls::stream <ap_uint <KEYW>>& i_key_strm,
	    hls::stream <ap_uint <PW>>& i_pld_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <KEYW>>& o_t_key_strm,
	    hls::stream <ap_uint <T_PW>>& o_t_pld_strm,
	    hls::stream <ap_uint <ARW>>& o_nm_strm,
	    hls::stream <bool>& o_e0_strm,
	    hls::stream <ap_uint <KEYW>>& o_base_s_key_strm,
	    hls::stream <ap_uint <S_PW>>& o_base_s_pld_strm,
	    hls::stream <ap_uint <KEYW>>& o_overflow_s_key_strm,
	    hls::stream <ap_uint <S_PW>>& o_overflow_s_pld_strm,
	    ap_uint <256>* htb_buf,
	    ap_uint <256>* stb_buf,
	    ap_uint <72>* bit_vector0,
	    ap_uint <72>* bit_vector1
	    )

Top function of hash join probe.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1aeb9ff5af88a8ac0c33717acc64e0f1eb:
.. _cid-xf::database::details::join_v3::sc::initiate_uram:

initiate_uram
-------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASHW,
	    int ARW
	    >
	void initiate_uram (
	    ap_uint <72>* bit_vector0,
	    ap_uint <72>* bit_vector1
	    )

Initiate uram to zero or read previous stored hash counter.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a6bae57058fb8311d6e19c60e542218bf:
.. _cid-xf::database::details::join_v3::sc::build_merge_probe_wrapper:

build_merge_probe_wrapper
-------------------------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int HASH_MODE,
	    int HASHWH,
	    int HASHWL,
	    int KEYW,
	    int S_PW,
	    int T_PW,
	    int ARW
	    >
	void build_merge_probe_wrapper (
	    ap_uint <32>& depth,
	    hls::stream <ap_uint <HASHWL>>& i_hash_strm,
	    hls::stream <ap_uint <KEYW>>& i_key_strm,
	    hls::stream <ap_uint <T_PW>>& i_pld_strm,
	    hls::stream <bool>& i_e_strm,
	    hls::stream <ap_uint <KEYW>>& o_t_key_strm,
	    hls::stream <ap_uint <T_PW>>& o_t_pld_strm,
	    hls::stream <ap_uint <ARW>>& o_nm_strm,
	    hls::stream <bool>& o_e_strm,
	    hls::stream <ap_uint <KEYW>>& o_base_s_key_strm,
	    hls::stream <ap_uint <S_PW>>& o_base_s_pld_strm,
	    hls::stream <ap_uint <KEYW>>& o_overflow_s_key_strm,
	    hls::stream <ap_uint <S_PW>>& o_overflow_s_pld_strm,
	    ap_uint <256>* htb_buf,
	    ap_uint <256>* stb_buf
	    )

Top function of hash join PU.

.. _doxid-namespacexf_1_1database_1_1details_1_1join__v3_1_1sc_1a544fabcf74d9b82450c7864a4dc11299:
.. _cid-xf::database::details::join_v3::sc::join_unit:

join_unit
---------


.. code-block:: cpp
	
	#include "xf_database/hash_join_v3.hpp"



.. ref-code-block:: cpp
	:class: title-code-block

	template <
	    int KEYW,
	    int S_PW,
	    int T_PW,
	    int ARW
	    >
	void join_unit (
	    int pu_id,
	    ap_uint <32>& depth,
	    hls::stream <ap_uint <KEYW>>& i_t_key_strm,
	    hls::stream <ap_uint <T_PW>>& i_t_pld_strm,
	    hls::stream <ap_uint <ARW>>& i_nm_strm,
	    hls::stream <bool>& i_e0_strm,
	    hls::stream <ap_uint <KEYW>>& i_base_s_key_strm,
	    hls::stream <ap_uint <S_PW>>& i_base_s_pld_strm,
	    hls::stream <ap_uint <KEYW>>& i_overflow_s_key_strm,
	    hls::stream <ap_uint <S_PW>>& i_overflow_s_pld_strm,
	    hls::stream <ap_uint <KEYW+S_PW+T_PW>>& o_j_strm,
	    hls::stream <bool>& o_e_strm
	    )

compare key, if match output joined row

